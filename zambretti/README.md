Zambretti code taken from https://searchcode.com/file/12858998/pywws/ZambrettiCore.py/